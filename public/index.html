<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ù„ÙØ§Øª PDF - Ù†Ø³Ø®Ø© Ù…Ø­Ø³Ù‘Ù†Ø©</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container { 
      max-width: 800px; 
      margin: auto; 
      background: white; 
      padding: 40px; 
      border-radius: 20px; 
      box-shadow: 0 20px 60px rgba(0,0,0,0.15);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #3498db, #2ecc71, #f39c12, #e74c3c);
    }
    
    h1 { 
      color: #2c3e50; 
      margin-bottom: 30px;
      font-size: 2.5rem;
      font-weight: 700;
    }
    
    .upload-box { 
      border: 3px dashed #3498db; 
      padding: 60px 40px; 
      border-radius: 16px; 
      cursor: pointer; 
      margin-bottom: 30px;
      transition: all 0.3s ease;
      background: linear-gradient(45deg, #f8f9fa, #ffffff);
      position: relative;
    }
    
    .upload-box:hover {
      border-color: #2980b9;
      background: linear-gradient(45deg, #ecf0f1, #f8f9fa);
      transform: scale(1.02);
    }
    
    .upload-box.dragover {
      border-color: #27ae60;
      background: linear-gradient(45deg, #d5f4e6, #ffffff);
      transform: scale(1.05);
    }

    .upload-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      display: block;
      color: #3498db;
    }
    
    .upload-text {
      font-size: 1.2rem;
      color: #34495e;
      margin-bottom: 10px;
    }

    .file-info {
      font-size: 0.9rem;
      color: #7f8c8d;
    }
    
    .btn { 
      background: linear-gradient(45deg, #3498db, #2980b9);
      color: white; 
      padding: 14px 28px; 
      border: none; 
      border-radius: 25px; 
      cursor: pointer; 
      font-size: 1rem;
      margin: 10px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
    }
    
    .btn:hover { 
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
    }

    .btn:disabled {
      background: #bdc3c7;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn-success {
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
    }

    .btn-danger {
      background: linear-gradient(45deg, #e74c3c, #c0392b);
      box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
    }
    
    .progress-container {
      width: 100%;
      height: 8px;
      background: #ecf0f1;
      border-radius: 10px;
      overflow: hidden;
      margin: 20px 0;
      display: none;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #3498db, #2ecc71);
      width: 0%;
      transition: width 0.3s ease;
      border-radius: 10px;
    }

    .progress-text {
      margin-top: 10px;
      font-size: 0.9rem;
      color: #34495e;
    }
    
    .file-link { 
      margin-top: 30px; 
      padding: 20px; 
      background: linear-gradient(45deg, #f8f9fa, #ffffff);
      border: 2px solid #e9ecef; 
      border-radius: 12px; 
      word-break: break-all; 
      display: none;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.05);
    }

    .status {
      margin: 20px 0;
      padding: 15px;
      border-radius: 10px;
      font-weight: 500;
    }

    .status.success {
      background: linear-gradient(45deg, #d5f4e6, #ffffff);
      color: #27ae60;
      border: 1px solid #27ae60;
    }

    .status.error {
      background: linear-gradient(45deg, #fadbd8, #ffffff);
      color: #e74c3c;
      border: 1px solid #e74c3c;
    }

    .status.info {
      background: linear-gradient(45deg, #d6eaf8, #ffffff);
      color: #3498db;
      border: 1px solid #3498db;
    }

    .file-details {
      display: none;
      margin-top: 20px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      text-align: right;
    }

    .file-details p {
      margin: 5px 0;
      color: #34495e;
    }

    .controls {
      margin-top: 20px;
      display: none;
    }

    @media (max-width: 768px) {
      .container {
        margin: 10px;
        padding: 20px;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .upload-box {
        padding: 40px 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“„ Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ù„ÙØ§Øª PDF</h1>
    <div class="upload-box" id="uploadBox" onclick="document.getElementById('pdfFile').click()">
      <div class="upload-icon">â˜ï¸</div>
      <div class="upload-text">Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ù…Ù„Ù PDF Ù‡Ù†Ø§ Ù„Ù„Ø±ÙØ¹</div>
      <div class="file-info">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 500 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª | ÙŠØ¯Ø¹Ù…: PDF</div>
    </div>
    
    <input type="file" id="pdfFile" accept=".pdf" style="display:none" multiple>
    
    <div class="progress-container" id="progressContainer">
      <div class="progress-bar" id="progressBar"></div>
      <div class="progress-text" id="progressText">0%</div>
    </div>
    
    <div id="status"></div>
    
    <div class="file-details" id="fileDetails">
      <p><strong>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</strong> <span id="fileName"></span></p>
      <p><strong>Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù:</strong> <span id="fileSize"></span></p>
      <p><strong>Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù:</strong> <span id="fileType"></span></p>
    </div>
    
    <div class="file-link" id="fileLink"></div>
    
    <div class="controls" id="controls">
      <button class="btn btn-success" id="copyBtn" onclick="copyLink()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
      <button class="btn" id="downloadBtn" onclick="downloadFile()">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù</button>
      <button class="btn btn-danger" onclick="resetUpload()">ğŸ”„ Ø±ÙØ¹ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯</button>
    </div>
  </div>

  <script>
    const fileInput = document.getElementById("pdfFile");
    const statusDiv = document.getElementById("status");
    const fileLinkDiv = document.getElementById("fileLink");
    const copyBtn = document.getElementById("copyBtn");
    const uploadBox = document.getElementById("uploadBox");
    const progressContainer = document.getElementById("progressContainer");
    const progressBar = document.getElementById("progressBar");
    const progressText = document.getElementById("progressText");
    const fileDetails = document.getElementById("fileDetails");
    const controls = document.getElementById("controls");
    
    let currentShareUrl = "";
    let currentFile = null;
    let uploadAbortController = null;

    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
    uploadBox.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadBox.classList.add('dragover');
    });

    uploadBox.addEventListener('dragleave', () => {
      uploadBox.classList.remove('dragover');
    });

    uploadBox.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadBox.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        handleFile(files[0]);
      }
    });

    fileInput.addEventListener("change", (e) => {
      if (e.target.files.length > 0) {
        handleFile(e.target.files[0]);
      }
    });

    function handleFile(file) {
      if (!file) return;
      
      if (file.type !== "application/pdf") {
        showStatus("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù PDF ÙÙ‚Ø·", "error");
        return;
      }
      
      // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¬Ù… (500 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª)
      const maxSize = 500 * 1024 * 1024;
      if (file.size > maxSize) {
        showStatus("Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 500 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª", "error");
        return;
      }

      currentFile = file;
      showFileDetails(file);
      
      // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±ÙØ¹ Ù…Ø¹ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
      uploadFileWithProgress(file).catch(error => {
        if (error.message !== 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±ÙØ¹') {
          showStatus("âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø±ÙØ¹: " + error.message, "error");
        }
        resetProgress();
      });
    }

    function showFileDetails(file) {
      document.getElementById("fileName").textContent = file.name;
      document.getElementById("fileSize").textContent = formatFileSize(file.size);
      document.getElementById("fileType").textContent = file.type;
      fileDetails.style.display = "block";
    }

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Ø¨Ø§ÙŠØª';
      const k = 1024;
      const sizes = ['Ø¨Ø§ÙŠØª', 'ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª', 'Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª', 'Ø¬ÙŠØ¬Ø§Ø¨Ø§ÙŠØª'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    async function uploadFile(file) {
      // Ø¥Ù†Ø´Ø§Ø¡ controller Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¥Ù„ØºØ§Ø¡
      uploadAbortController = new AbortController();
      
      showStatus("ğŸš€ Ø¨Ø¯Ø¡ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù...", "info");
      progressContainer.style.display = "block";
      
      // Ø¥Ù†Ø´Ø§Ø¡ FormData Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù„Ù
      const formData = new FormData();
      formData.append("pdf", file);
      
      try {
        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù„Ù Ù„Ù„Ø®Ø§Ø¯Ù… Ù…Ø¹ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
        const response = await fetch("/api/upload", {
          method: "POST",
          body: formData,
          signal: uploadAbortController.signal,
          // Ù„Ø§ Ù†Ø¶Ø¹ Content-Type header - Ø³ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ†Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ù€ FormData
        });

        if (!response.ok) {
          throw new Error(`Ø®Ø·Ø£ HTTP: ${response.status}`);
        }

        const result = await response.json();
        
        if (result.success) {
          currentShareUrl = result.shareUrl;
          showUploadSuccess();
        } else {
          throw new Error(result.error || "Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø­Ø¯Ø¯");
        }
        
      } catch (error) {
        if (error.name === 'AbortError') {
          showStatus("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù", "error");
        } else {
          showStatus("âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø±ÙØ¹: " + error.message, "error");
        }
        resetProgress();
      }
    }

    // Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ù‚Ø¨Ø© ØªÙ‚Ø¯Ù… Ø§Ù„Ø±ÙØ¹ (ÙŠØ¹Ù…Ù„ Ù…Ø¹ XMLHttpRequest)
    async function uploadFileWithProgress(file) {
      uploadAbortController = new AbortController();
      
      showStatus("ğŸš€ Ø¨Ø¯Ø¡ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù...", "info");
      progressContainer.style.display = "block";
      
      return new Promise((resolve, reject) => {
        const formData = new FormData();
        formData.append("pdf", file);
        
        const xhr = new XMLHttpRequest();
        
        // Ù…Ø±Ø§Ù‚Ø¨Ø© ØªÙ‚Ø¯Ù… Ø§Ù„Ø±ÙØ¹
        xhr.upload.addEventListener('progress', (e) => {
          if (e.lengthComputable) {
            const progress = Math.round((e.loaded / e.total) * 100);
            updateProgress(progress);
          }
        });
        
        // Ø¹Ù†Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø±ÙØ¹
        xhr.addEventListener('load', () => {
          if (xhr.status === 200) {
            try {
              const result = JSON.parse(xhr.responseText);
              if (result.success) {
                currentShareUrl = result.shareUrl;
                showUploadSuccess();
                resolve(result);
              } else {
                reject(new Error(result.error || "Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø­Ø¯Ø¯"));
              }
            } catch (error) {
              reject(new Error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø¯Ù…"));
            }
          } else {
            reject(new Error(`Ø®Ø·Ø£ HTTP: ${xhr.status}`));
          }
        });
        
        // Ø¹Ù†Ø¯ Ø­Ø¯ÙˆØ« Ø®Ø·Ø£
        xhr.addEventListener('error', () => {
          reject(new Error("ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…"));
        });
        
        // Ø¹Ù†Ø¯ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±ÙØ¹
        xhr.addEventListener('abort', () => {
          reject(new Error("ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±ÙØ¹"));
        });
        
        // Ø±Ø¨Ø· Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±ÙØ¹ Ø¨Ø§Ù„Ù€ AbortController
        uploadAbortController.signal.addEventListener('abort', () => {
          xhr.abort();
        });
        
        xhr.open('POST', '/api/upload');
        xhr.send(formData);
      });
    }

    function updateProgress(progress) {
      progressBar.style.width = progress + '%';
      progressText.textContent = progress + '%';
      
      if (progress < 100) {
        showStatus(`ğŸ“¤ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹... ${progress}%`, "info");
      }
    }

    function showUploadSuccess() {
      showStatus("âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­!", "success");
      fileLinkDiv.innerHTML = `
        <strong>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©:</strong><br>
        <code style="background: #ecf0f1; padding: 8px; border-radius: 4px; display: inline-block; margin-top: 10px;">${currentShareUrl}</code>
        <br><br>
        <a href="${currentShareUrl}" target="_blank" style="color: #3498db; text-decoration: none;">ğŸ”— Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©</a>
      `;
      fileLinkDiv.style.display = "block";
      controls.style.display = "block";
      progressContainer.style.display = "none";
    }

    function showStatus(message, type = "info") {
      statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
    }

    function resetProgress() {
      progressBar.style.width = '0%';
      progressText.textContent = '0%';
      progressContainer.style.display = "none";
    }

    function resetUpload() {
      // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø±ÙØ¹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¬Ø§Ø±ÙŠØ§Ù‹
      if (uploadAbortController) {
        uploadAbortController.abort();
      }
      
      currentFile = null;
      currentShareUrl = "";
      fileInput.value = "";
      
      statusDiv.innerHTML = "";
      fileLinkDiv.style.display = "none";
      fileDetails.style.display = "none";
      controls.style.display = "none";
      resetProgress();
    }

    function copyLink() {
      if (!currentShareUrl) {
        showStatus("âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø§Ø¨Ø· Ù„Ù„Ù†Ø³Ø®", "error");
        return;
      }
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¯Ø¹Ù… clipboard API
      if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(currentShareUrl).then(() => {
          showStatus("âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!", "success");
          // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ù„Ù„Ø²Ø±
          copyBtn.innerHTML = "âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®!";
          copyBtn.style.background = "linear-gradient(45deg, #27ae60, #2ecc71)";
          setTimeout(() => {
            copyBtn.innerHTML = "ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·";
            copyBtn.style.background = "linear-gradient(45deg, #3498db, #2980b9)";
          }, 2000);
        }).catch((err) => {
          console.error('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·:', err);
          fallbackCopyTextToClipboard(currentShareUrl);
        });
      } else {
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©
        fallbackCopyTextToClipboard(currentShareUrl);
      }
    }

    function fallbackCopyTextToClipboard(text) {
      const textArea = document.createElement("textarea");
      textArea.value = text;
      textArea.style.position = "fixed";
      textArea.style.left = "-999999px";
      textArea.style.top = "-999999px";
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();
      
      try {
        const successful = document.execCommand('copy');
        if (successful) {
          showStatus("âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!", "success");
          copyBtn.innerHTML = "âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®!";
          copyBtn.style.background = "linear-gradient(45deg, #27ae60, #2ecc71)";
          setTimeout(() => {
            copyBtn.innerHTML = "ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·";
            copyBtn.style.background = "linear-gradient(45deg, #3498db, #2980b9)";
          }, 2000);
        } else {
          throw new Error('ÙØ´Ù„ ÙÙŠ ØªÙ†ÙÙŠØ° Ø£Ù…Ø± Ø§Ù„Ù†Ø³Ø®');
        }
      } catch (err) {
        console.error('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·:', err);
        showStatus("âŒ ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·. Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰", "error");
        
        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Øµ ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„ÙŠØ³Ù‡Ù„ Ù†Ø³Ø®Ù‡ ÙŠØ¯ÙˆÙŠØ§Ù‹
        const linkText = fileLinkDiv.querySelector('code');
        if (linkText) {
          const range = document.createRange();
          range.selectNode(linkText);
          window.getSelection().removeAllRanges();
          window.getSelection().addRange(range);
        }
      }
      
      document.body.removeChild(textArea);
    }

    function downloadFile() {
      if (currentShareUrl) {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· ØªØ­Ù…ÙŠÙ„ Ù…Ù† Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        const downloadUrl = currentShareUrl + '?display=download';
        window.open(downloadUrl, '_blank');
        showStatus("â¬‡ï¸ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù...", "info");
      } else if (currentFile) {
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­Ù„ÙŠ ÙƒÙ€ fallback
        const url = URL.createObjectURL(currentFile);
        const a = document.createElement('a');
        a.href = url;
        a.download = currentFile.name;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        showStatus("â¬‡ï¸ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù...", "info");
      }
    }

    function generateRandomId() {
      return Math.random().toString(36).substr(2, 9) + Date.now().toString(36);
    }

    // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey || e.metaKey) {
        if (e.key === 'c' && currentShareUrl && e.target.tagName !== 'INPUT') {
          e.preventDefault();
          copyLink();
        }
        if (e.key === 'o') {
          e.preventDefault();
          fileInput.click();
        }
      }
      if (e.key === 'Escape' && uploadAbortController) {
        uploadAbortController.abort();
      }
    });
  </script>
</body>
</html>
